<%- include('../navbar.ejs') %>

<main class="main-content">

    <!-- ===== TOP NAVBAR ===== -->
    <header class="top-navbar">
        <div class="page-title">
            <h1>Dashboard Overview</h1>
            <p>Welcome back! Here's what's happening with your events today.</p>
        </div>

        <div class="navbar-right">
            <div class="search-wrapper">
                <i class="fas fa-search search-icon"></i>
                <input type="text" placeholder="Search events, clients, payments...">
            </div>

            <div class="navbar-icons">
                <div class="nav-icon">
                    <i class="far fa-bell"></i>
                    <span class="notification-badge">5</span>
                </div>
                <div class="nav-icon">
                    <i class="far fa-envelope"></i>
                    <span class="notification-badge">3</span>
                </div>
                <div class="nav-icon">
                    <i class="fas fa-cog"></i>
                </div>
            </div>
        </div>
    </header>

    <!-- ===== DASHBOARD CONTENT ===== -->
    <div class="dashboard-content">

        <style>
            .card {
                border-radius: 15px;
                box-shadow: 0 10px 25px rgba(0,0,0,0.08);
                background: #fff;
            }

            .form-card {
                max-width: 900px;
                margin: 0 auto 30px auto;
                padding: 25px;
            }

            .form-label {
                font-weight: 600;
                color: #2c3e50;
            }

            .form-control {
                border-radius: 10px;
                padding: 12px;
            }

            .btn-primary {
                border-radius: 10px;
                padding: 10px 25px;
            }
        </style>

        <!-- ===== ALERTS ===== -->
        <% if (success) { %>
        <div class="alert alert-success alert-dismissible fade show">
            <%= success %>
            <button class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        <% } %>

        <% if (error) { %>
        <div class="alert alert-danger alert-dismissible fade show">
            <%= error %>
            <button class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        <% } %>

        <!-- ===== ADD FAQ FORM ===== -->
        <div class="card form-card">
            <h4 class="mb-4">
                <i class="fas fa-plus-circle me-2 text-primary"></i>
                Add New FAQ
            </h4>

            <form action="/admin/save_faq" method="POST" id="faqForm">
                <div class="mb-4">
                    <label class="form-label">
                        <i class="fas fa-question-circle"></i> Question *
                    </label>
                    <input type="text" class="form-control" name="question"
                           placeholder="Enter your question here..." required>
                    <small class="text-muted">Minimum 5 characters</small>
                </div>

                <div class="mb-4">
                    <label class="form-label">
                        <i class="fas fa-comment-alt"></i> Answer *
                    </label>
                    <textarea class="form-control" name="answer"
                              rows="6"
                              placeholder="Provide a detailed answer..." required></textarea>
                    <small class="text-muted">Maximum 5000 characters</small>
                </div>

                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save me-2"></i> Save FAQ
                </button>
            </form>
        </div>

        <!-- ===== FAQ TABLE ===== -->
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">
                    <i class="fas fa-question-circle me-2"></i> All FAQs
                </h5>
                <span class="badge bg-primary">
                    <%= faqs.length %> FAQs
                </span>
            </div>

            <div class="card-body p-0">

                <% if (faqs.length === 0) { %>
                    <div class="text-center py-5">
                        <i class="fas fa-question-circle fa-3x text-muted mb-3"></i>
                        <h5 class="text-muted">No FAQs Found</h5>
                    </div>
                <% } else { %>

                <table class="table table-hover align-middle mb-0">
                    <thead class="table-dark">
                        <tr>
                            <th>#</th>
                            <th>Question</th>
                            <th>Answer</th>
                            <th width="150">Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% faqs.forEach((faq, i) => { %>
                        <tr>
                            <td><%= i + 1 %></td>
                            <td><strong><%= faq.question %></strong></td>
                            <td>
                                <%= faq.answer.length > 150 
                                    ? faq.answer.substring(0,150) + '...' 
                                    : faq.answer %>
                            </td>
                            <td>
                                <a href="/admin/edit_faq/<%= faq.id %>"
                                   class="btn btn-sm btn-warning me-2">
                                    <i class="fas fa-edit"></i>
                                </a>

                                <a href="/admin/delete_faq/<%= faq.id %>"
                                   onclick="return confirm('Delete this FAQ?')"
                                   class="btn btn-sm btn-danger">
                                    <i class="fas fa-trash"></i>
                                </a>
                            </td>
                        </tr>
                        <% }) %>
                    </tbody>
                </table>

                <% } %>
            </div>
        </div>

    </div>

<script>
document.getElementById('faqForm').addEventListener('submit', function(e) {
    const question = this.question.value.trim();
    const answer = this.answer.value.trim();

    if (question.length < 5) {
        e.preventDefault();
        alert('Question must be at least 5 characters');
    }

    if (answer.length < 10) {
        e.preventDefault();
        alert('Answer must be at least 10 characters');
    }
});
</script>

<%- include('../footer.ejs') %>
