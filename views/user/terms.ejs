<%- include('navbar.ejs') %>

<!-- Scroll Progress Bar -->
<div class="scroll-progress">
  <div class="scroll-progress-bar" id="scrollProgress"></div>
</div>

<link rel="stylesheet" href="/css/terms.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<div class="terms-page-container">
<main>
<div class="terms-container">

  <!-- ================= HERO ================= -->
  <div class="terms-hero">
    <div class="terms-hero-content">
      <h1>Terms & Conditions</h1>
      <p class="terms-subtitle">
        Please read these terms carefully before using our event management platform
      </p>
      <p class="last-updated">
        Last Updated: <%= new Date().toDateString() %>
      </p>
    </div>
  </div>

  <!-- ================= CONTENT ================= -->
  <div class="terms-content-wrapper">
  <div class="terms-content">

    <!-- ===== SIDEBAR ===== -->
    <aside class="terms-sidebar">
      <div style="background:black">
        <h3>Quick Navigation</h3>
      </div>

      <ul class="terms-nav">
        <% terms.forEach(function(term, index){ %>
          <li>
            <a href="#term-<%= term.id %>" class="<%= index === 0 ? 'active' : '' %>">
              <%= index + 1 %>.
              <%= term.term_title.replace(/<[^>]*>/g, '') %>
            </a>
          </li>
        <% }) %>
      </ul>
    </aside>

    <!-- ===== TERMS SECTIONS ===== -->
    <div class="terms-sections">

      <% terms.forEach(function(term, index){ %>

        <div id="term-<%= term.id %>" class="terms-section">

          <div class="terms-section-number">
            <%= index + 1 %>
          </div>

          <!-- ✅ TITLE HTML RENDER -->
          <h2>
            <%- term.term_title %>
          </h2>

          <!-- ✅ CONTENT HTML RENDER -->
          <div class="terms-body">
            <%- term.term_content %>
          </div>

        </div>

        <% if(index !== terms.length - 1){ %>
          <div class="section-divider"></div>
        <% } %>

      <% }) %>

    </div>

  </div>
  </div>

</div>
</main>

<!-- BACK TO TOP -->
<button class="back-to-top" id="backToTop">
  <i class="fas fa-arrow-up"></i>
</button>

<%- include('footer.ejs') %>
</div>

<!-- ================= JS ================= -->
<script>
const backToTop = document.getElementById('backToTop');
const scrollProgress = document.getElementById('scrollProgress');

window.addEventListener('scroll', () => {
  const windowHeight =
    document.documentElement.scrollHeight -
    document.documentElement.clientHeight;

  const scrolled = (window.scrollY / windowHeight) * 100;
  scrollProgress.style.width = scrolled + '%';

  if (window.scrollY > 300) {
    backToTop.classList.add('visible');
  } else {
    backToTop.classList.remove('visible');
  }
});

backToTop.addEventListener('click', () => {
  window.scrollTo({ top: 0, behavior: 'smooth' });
});

document.querySelectorAll('.terms-nav a').forEach(anchor => {
  anchor.addEventListener('click', function (e) {
    e.preventDefault();

    document.querySelectorAll('.terms-nav a')
      .forEach(a => a.classList.remove('active'));

    this.classList.add('active');

    const target = document.querySelector(this.getAttribute('href'));
    if (target) {
      window.scrollTo({
        top: target.offsetTop - 100,
        behavior: 'smooth'
      });
    }
  });
});

window.addEventListener('scroll', () => {
  const sections = document.querySelectorAll('.terms-section');
  const navLinks = document.querySelectorAll('.terms-nav a');

  let current = '';
  sections.forEach(section => {
    if (scrollY >= section.offsetTop - 200) {
      current = section.getAttribute('id');
    }
  });

  navLinks.forEach(link => {
    link.classList.remove('active');
    if (link.getAttribute('href') === `#${current}`) {
      link.classList.add('active');
    }
  });
});
</script>